{"type":"module","name":"perf_bench","heap_cap":262144}
{"type":"import","name":"_ctl"}
{"type":"import","name":"_write"}
{"type":"import","name":"_clock_gettime_monotonic_ns"}
{"type":"data","name":"req_buf","size":96,"align":8}
{"type":"data","name":"resp_buf","size":96,"align":8}
{"type":"data","name":"msg_warmup","size":32,"align":1,"init":"string","value":"Warming up GPU...\n"}
{"type":"data","name":"msg_running","size":32,"align":1,"init":"string","value":"Running benchmark...\n"}
{"type":"data","name":"msg_iter","size":16,"align":1,"init":"string","value":"Iteration "}
{"type":"data","name":"msg_nl","size":2,"align":1,"init":"string","value":"\n"}
{"type":"data","name":"msg_done","size":32,"align":1,"init":"string","value":"Benchmark complete\n"}
{"type":"data","name":"msg_time","size":16,"align":1,"init":"string","value":"Total time: "}
{"type":"data","name":"msg_ns","size":4,"align":1,"init":"string","value":" ns\n"}
{"type":"data","name":"msg_throughput","size":16,"align":1,"init":"string","value":"Throughput: "}
{"type":"data","name":"msg_ops","size":8,"align":1,"init":"string","value":" ops/s\n"}
{"type":"data","name":"time_start","size":8,"align":8}
{"type":"data","name":"time_end","size":8,"align":8}
{"type":"data","name":"time_diff","size":8,"align":8}
{"type":"func","name":"main"}
{"type":"insn","op":"local.decl","name":"iter","dtype":"u32"}
{"type":"insn","op":"local.decl","name":"status","dtype":"u32"}
{"type":"insn","op":"local.decl","name":"elem_count","dtype":"u32"}
{"type":"insn","op":"local.decl","name":"throughput","dtype":"u64"}
{"type":"insn","op":"const.u32","dest":"elem_count","value":1024}
{"type":"insn","op":"ref","dest":"$0","name":"msg_warmup"}
{"type":"insn","op":"const.u32","dest":"$1","value":18}
{"type":"insn","op":"call","target":"_write","args":["$0","$1"]}
{"type":"insn","op":"const.u32","dest":"iter","value":0}
{"type":"label","name":"warmup_loop"}
{"type":"insn","op":"const.u32","dest":"$0","value":10}
{"type":"insn","op":"cmp.ge.u32","dest":"$1","left":"iter","right":"$0"}
{"type":"insn","op":"br.true","cond":"$1","target":"warmup_done"}
{"type":"insn","op":"ref","dest":"$0","name":"req_buf"}
{"type":"insn","op":"const.u32","dest":"$1","value":90}
{"type":"insn","op":"call","target":"build_kernel_run_req","args":["$0","$1","elem_count"]}
{"type":"insn","op":"ref","dest":"$0","name":"req_buf"}
{"type":"insn","op":"const.u32","dest":"$1","value":48}
{"type":"insn","op":"ref","dest":"$2","name":"resp_buf"}
{"type":"insn","op":"const.u32","dest":"$3","value":96}
{"type":"insn","op":"call","target":"_ctl","args":["$0","$1","$2","$3"],"dest":"status"}
{"type":"insn","op":"const.u32","dest":"$0","value":1}
{"type":"insn","op":"add.u32","dest":"iter","left":"iter","right":"$0"}
{"type":"insn","op":"br","target":"warmup_loop"}
{"type":"label","name":"warmup_done"}
{"type":"insn","op":"ref","dest":"$0","name":"msg_running"}
{"type":"insn","op":"const.u32","dest":"$1","value":21}
{"type":"insn","op":"call","target":"_write","args":["$0","$1"]}
{"type":"insn","op":"ref","dest":"$0","name":"time_start"}
{"type":"insn","op":"call","target":"_clock_gettime_monotonic_ns","args":["$0"]}
{"type":"insn","op":"const.u32","dest":"iter","value":0}
{"type":"label","name":"bench_loop"}
{"type":"insn","op":"const.u32","dest":"$0","value":1000}
{"type":"insn","op":"cmp.ge.u32","dest":"$1","left":"iter","right":"$0"}
{"type":"insn","op":"br.true","cond":"$1","target":"bench_done"}
{"type":"insn","op":"ref","dest":"$0","name":"req_buf"}
{"type":"insn","op":"const.u32","dest":"$1","value":90}
{"type":"insn","op":"call","target":"build_kernel_run_req","args":["$0","$1","elem_count"]}
{"type":"insn","op":"ref","dest":"$0","name":"req_buf"}
{"type":"insn","op":"const.u32","dest":"$1","value":48}
{"type":"insn","op":"ref","dest":"$2","name":"resp_buf"}
{"type":"insn","op":"const.u32","dest":"$3","value":96}
{"type":"insn","op":"call","target":"_ctl","args":["$0","$1","$2","$3"],"dest":"status"}
{"type":"insn","op":"const.u32","dest":"$0","value":1}
{"type":"insn","op":"add.u32","dest":"iter","left":"iter","right":"$0"}
{"type":"insn","op":"br","target":"bench_loop"}
{"type":"label","name":"bench_done"}
{"type":"insn","op":"ref","dest":"$0","name":"time_end"}
{"type":"insn","op":"call","target":"_clock_gettime_monotonic_ns","args":["$0"]}
{"type":"insn","op":"ref","dest":"$0","name":"msg_done"}
{"type":"insn","op":"const.u32","dest":"$1","value":19}
{"type":"insn","op":"call","target":"_write","args":["$0","$1"]}
{"type":"insn","op":"ref","dest":"$0","name":"time_start"}
{"type":"insn","op":"load.u64","dest":"$1","addr":"$0"}
{"type":"insn","op":"ref","dest":"$2","name":"time_end"}
{"type":"insn","op":"load.u64","dest":"$3","addr":"$2"}
{"type":"insn","op":"sub.u64","dest":"$4","left":"$3","right":"$1"}
{"type":"insn","op":"ref","dest":"$5","name":"time_diff"}
{"type":"insn","op":"store.u64","addr":"$5","value":"$4"}
{"type":"insn","op":"ref","dest":"$0","name":"msg_time"}
{"type":"insn","op":"const.u32","dest":"$1","value":12}
{"type":"insn","op":"call","target":"_write","args":["$0","$1"]}
{"type":"insn","op":"ref","dest":"$0","name":"time_diff"}
{"type":"insn","op":"call","target":"print_u64","args":["$0"]}
{"type":"insn","op":"ref","dest":"$0","name":"msg_ns"}
{"type":"insn","op":"const.u32","dest":"$1","value":4}
{"type":"insn","op":"call","target":"_write","args":["$0","$1"]}
{"type":"insn","op":"ref","dest":"$0","name":"time_diff"}
{"type":"insn","op":"load.u64","dest":"$1","addr":"$0"}
{"type":"insn","op":"const.u64","dest":"$2","value":1000000000000}
{"type":"insn","op":"div.u64","dest":"throughput","left":"$2","right":"$1"}
{"type":"insn","op":"ref","dest":"$0","name":"msg_throughput"}
{"type":"insn","op":"const.u32","dest":"$1","value":12}
{"type":"insn","op":"call","target":"_write","args":["$0","$1"]}
{"type":"insn","op":"ref","dest":"$0","name":"throughput"}
{"type":"insn","op":"call","target":"print_u64","args":["$0"]}
{"type":"insn","op":"ref","dest":"$0","name":"msg_ops"}
{"type":"insn","op":"const.u32","dest":"$1","value":7}
{"type":"insn","op":"call","target":"_write","args":["$0","$1"]}
{"type":"insn","op":"const.u32","dest":"$0","value":0}
{"type":"insn","op":"ret","value":"$0"}
{"type":"func","name":"build_kernel_run_req"}
{"type":"insn","op":"param","name":"req_ptr","dtype":"ptr"}
{"type":"insn","op":"param","name":"buf_size","dtype":"u32"}
{"type":"insn","op":"param","name":"elem_count","dtype":"u32"}
{"type":"insn","op":"local.decl","name":"i","dtype":"u32"}
{"type":"insn","op":"local.decl","name":"kernel_id","dtype":"u32"}
{"type":"insn","op":"local.decl","name":"arg_count","dtype":"u32"}
{"type":"insn","op":"const.u32","dest":"kernel_id","value":1}
{"type":"insn","op":"const.u32","dest":"arg_count","value":4}
{"type":"insn","op":"const.u32","dest":"i","value":0}
{"type":"label","name":"clear_loop"}
{"type":"insn","op":"cmp.ge.u32","dest":"$0","left":"i","right":"buf_size"}
{"type":"insn","op":"br.true","cond":"$0","target":"clear_done"}
{"type":"insn","op":"add.ptr","dest":"$0","base":"req_ptr","offset":"i"}
{"type":"insn","op":"const.u8","dest":"$1","value":0}
{"type":"insn","op":"store.u8","addr":"$0","value":"$1"}
{"type":"insn","op":"const.u32","dest":"$0","value":1}
{"type":"insn","op":"add.u32","dest":"i","left":"i","right":"$0"}
{"type":"insn","op":"br","target":"clear_loop"}
{"type":"label","name":"clear_done"}
{"type":"insn","op":"const.u8","dest":"$0","value":90}
{"type":"insn","op":"store.u8","addr":"req_ptr","value":"$0"}
{"type":"insn","op":"const.u32","dest":"$0","value":1}
{"type":"insn","op":"add.ptr","dest":"$1","base":"req_ptr","offset":"$0"}
{"type":"insn","op":"const.u8","dest":"$2","value":67}
{"type":"insn","op":"store.u8","addr":"$1","value":"$2"}
{"type":"insn","op":"const.u32","dest":"$0","value":2}
{"type":"insn","op":"add.ptr","dest":"$1","base":"req_ptr","offset":"$0"}
{"type":"insn","op":"const.u8","dest":"$2","value":84}
{"type":"insn","op":"store.u8","addr":"$1","value":"$2"}
{"type":"insn","op":"const.u32","dest":"$0","value":3}
{"type":"insn","op":"add.ptr","dest":"$1","base":"req_ptr","offset":"$0"}
{"type":"insn","op":"const.u8","dest":"$2","value":76}
{"type":"insn","op":"store.u8","addr":"$1","value":"$2"}
{"type":"insn","op":"const.u32","dest":"$0","value":4}
{"type":"insn","op":"add.ptr","dest":"$1","base":"req_ptr","offset":"$0"}
{"type":"insn","op":"const.u8","dest":"$2","value":1}
{"type":"insn","op":"store.u8","addr":"$1","value":"$2"}
{"type":"insn","op":"const.u32","dest":"$0","value":6}
{"type":"insn","op":"add.ptr","dest":"$1","base":"req_ptr","offset":"$0"}
{"type":"insn","op":"const.u8","dest":"$2","value":2}
{"type":"insn","op":"store.u8","addr":"$1","value":"$2"}
{"type":"insn","op":"const.u32","dest":"$0","value":7}
{"type":"insn","op":"add.ptr","dest":"$1","base":"req_ptr","offset":"$0"}
{"type":"insn","op":"const.u8","dest":"$2","value":1}
{"type":"insn","op":"store.u8","addr":"$1","value":"$2"}
{"type":"insn","op":"const.u32","dest":"$0","value":32}
{"type":"insn","op":"add.ptr","dest":"$1","base":"req_ptr","offset":"$0"}
{"type":"insn","op":"store.u32","addr":"$1","value":"kernel_id"}
{"type":"insn","op":"const.u32","dest":"$0","value":36}
{"type":"insn","op":"add.ptr","dest":"$1","base":"req_ptr","offset":"$0"}
{"type":"insn","op":"store.u32","addr":"$1","value":"arg_count"}
{"type":"insn","op":"const.u32","dest":"$0","value":40}
{"type":"insn","op":"add.ptr","dest":"$1","base":"req_ptr","offset":"$0"}
{"type":"insn","op":"store.u32","addr":"$1","value":"elem_count"}
{"type":"insn","op":"const.u32","dest":"$0","value":44}
{"type":"insn","op":"add.ptr","dest":"$1","base":"req_ptr","offset":"$0"}
{"type":"insn","op":"store.u32","addr":"$1","value":"elem_count"}
{"type":"insn","op":"ret"}
{"type":"func","name":"print_u64"}
{"type":"insn","op":"param","name":"val_ptr","dtype":"ptr"}
{"type":"insn","op":"local.decl","name":"val","dtype":"u64"}
{"type":"insn","op":"local.decl","name":"digit","dtype":"u8"}
{"type":"insn","op":"local.decl","name":"buf","dtype":"u8","count":24}
{"type":"insn","op":"local.decl","name":"i","dtype":"u32"}
{"type":"insn","op":"load.u64","dest":"val","addr":"val_ptr"}
{"type":"insn","op":"const.u32","dest":"i","value":23}
{"type":"label","name":"digit_loop"}
{"type":"insn","op":"const.u64","dest":"$0","value":0}
{"type":"insn","op":"cmp.eq.u64","dest":"$1","left":"val","right":"$0"}
{"type":"insn","op":"const.u32","dest":"$2","value":0}
{"type":"insn","op":"cmp.eq.u32","dest":"$3","left":"i","right":"$2"}
{"type":"insn","op":"or.u32","dest":"$4","left":"$1","right":"$3"}
{"type":"insn","op":"br.true","cond":"$4","target":"digit_done"}
{"type":"insn","op":"const.u64","dest":"$0","value":10}
{"type":"insn","op":"mod.u64","dest":"$1","left":"val","right":"$0"}
{"type":"insn","op":"trunc.u8","dest":"digit","value":"$1"}
{"type":"insn","op":"const.u8","dest":"$0","value":48}
{"type":"insn","op":"add.u8","dest":"digit","left":"digit","right":"$0"}
{"type":"insn","op":"ref","dest":"$0","name":"buf"}
{"type":"insn","op":"add.ptr","dest":"$1","base":"$0","offset":"i"}
{"type":"insn","op":"store.u8","addr":"$1","value":"digit"}
{"type":"insn","op":"const.u64","dest":"$0","value":10}
{"type":"insn","op":"div.u64","dest":"val","left":"val","right":"$0"}
{"type":"insn","op":"const.u32","dest":"$0","value":1}
{"type":"insn","op":"sub.u32","dest":"i","left":"i","right":"$0"}
{"type":"insn","op":"br","target":"digit_loop"}
{"type":"label","name":"digit_done"}
{"type":"insn","op":"const.u64","dest":"$0","value":0}
{"type":"insn","op":"cmp.eq.u64","dest":"$1","left":"val","right":"$0"}
{"type":"insn","op":"br.false","cond":"$1","target":"write_digits"}
{"type":"insn","op":"ref","dest":"$0","name":"buf"}
{"type":"insn","op":"add.ptr","dest":"$1","base":"$0","offset":"i"}
{"type":"insn","op":"const.u8","dest":"$2","value":48}
{"type":"insn","op":"store.u8","addr":"$1","value":"$2"}
{"type":"label","name":"write_digits"}
{"type":"insn","op":"const.u32","dest":"$0","value":1}
{"type":"insn","op":"add.u32","dest":"$1","left":"i","right":"$0"}
{"type":"insn","op":"ref","dest":"$2","name":"buf"}
{"type":"insn","op":"add.ptr","dest":"$3","base":"$2","offset":"$1"}
{"type":"insn","op":"const.u32","dest":"$4","value":23}
{"type":"insn","op":"sub.u32","dest":"$5","left":"$4","right":"i"}
{"type":"insn","op":"call","target":"_write","args":["$3","$5"]}
{"type":"insn","op":"ret"}
